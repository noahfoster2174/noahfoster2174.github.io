<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Feed — Noah Foster</title>
  <meta name="description" content="What Noah Foster is training for, building, and watching." />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect width='32' height='32' rx='4' fill='%232D6A4F'/><text x='50%25' y='50%25' dominant-baseline='central' text-anchor='middle' font-family='Georgia,serif' font-weight='700' font-size='14' fill='white'>NF</text></svg>" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Spectral:wght@400;600;700&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    :root { --accent: #2D6A4F; --text: #1A1A1A; --muted: #5E6E5E; --border: #D5DCD5; --bg: #F7F6F1; --surface: #EDECE7; --dark: #1A2B22; --light-text: #A8B5A8; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); line-height: 1.65; }

    header { border-bottom: 1px solid var(--border); padding: 2rem 0 1.5rem; }
    .container { max-width: 1000px; margin: 0 auto; padding: 0 2rem; }
    .site-title { font-family: 'Spectral', serif; font-size: 2.4rem; font-weight: 700; letter-spacing: -0.5px; }
    .site-title a { text-decoration: none; color: inherit; }
    .site-title span { display: inline-block; border-bottom: 3px solid var(--accent); padding-bottom: 2px; }
    nav { margin-top: 0.75rem; display: flex; gap: 1.5rem; }
    nav a { font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.08em; color: var(--muted); text-decoration: none; font-weight: 600; transition: color 0.15s ease; }
    nav a:hover, nav a[aria-current] { color: var(--accent); }
    nav a:focus-visible,
    .feed-link:focus-visible,
    .footer-contact a:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 3px;
      border-radius: 2px;
    }

    .skip-link { position: absolute; top: -100%; left: 1rem; background: var(--accent); color: #fff; padding: 0.5rem 1rem; font-size: 0.85rem; font-weight: 700; text-decoration: none; border-radius: 0 0 4px 4px; z-index: 100; }
    .skip-link:focus { top: 0; }

    .section-label { font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.12em; color: var(--accent); margin-bottom: 1.5rem; }

    /* ── Feed blocks ── */
    .feed-block { padding: 3.5rem 0; border-bottom: 1px solid var(--border); }
    .feed-block:last-of-type { border-bottom: none; }
    .feed-block-header { display: flex; align-items: baseline; justify-content: space-between; margin-bottom: 1.5rem; }
    .feed-link { font-size: 0.85rem; color: var(--muted); text-decoration: none; font-weight: 600; transition: color 0.15s ease; }
    .feed-link:hover { color: var(--accent); }

    /* ── Currently Training ── */
    .training-hero { margin-bottom: 1.5rem; }
    .training-race { font-family: 'Spectral', serif; font-size: clamp(1.8rem, 4vw, 2.8rem); font-weight: 700; line-height: 1.2; margin-bottom: 0.5rem; letter-spacing: -0.01em; }
    .training-race em { color: var(--accent); font-style: normal; }
    .training-desc { font-size: 1rem; color: var(--muted); line-height: 1.7; max-width: 600px; }
    .training-stats { display: flex; gap: 3rem; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border); }
    @media (max-width: 500px) { .training-stats { gap: 2rem; } }
    .training-stat { display: flex; flex-direction: column; gap: 0.1rem; }
    .training-stat-value { font-family: 'Spectral', serif; font-size: 2rem; font-weight: 700; line-height: 1; }
    .training-stat-label { font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em; color: var(--muted); }

    /* ── Currently Building ── */
    .building-list { list-style: none; display: flex; flex-direction: column; gap: 1rem; }
    .building-item { display: flex; gap: 1rem; align-items: baseline; }
    .building-name { font-family: 'Spectral', serif; font-size: 1.05rem; font-weight: 600; flex-shrink: 0; }
    .building-desc { font-size: 0.9rem; color: var(--muted); }
    .building-sep { color: var(--border); flex-shrink: 0; }

    /* ── Recently Watched ── */
    .film-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1.25rem; }
    @media (max-width: 600px) { .film-grid { grid-template-columns: repeat(2, 1fr); } }
    .film-card { display: flex; flex-direction: column; gap: 0.5rem; }
    .film-poster { width: 100%; aspect-ratio: 2/3; object-fit: cover; border: 1px solid var(--border); background: var(--surface); display: block; }
    .film-poster-placeholder { width: 100%; aspect-ratio: 2/3; background: var(--surface); border: 1px solid var(--border); }
    .film-title { font-weight: 600; font-size: 0.85rem; line-height: 1.3; }
    .film-rating { font-size: 0.85rem; color: var(--accent); }

    /* ── Empty / loading states ── */
    .feed-state { font-size: 0.9rem; color: var(--muted); font-style: italic; padding: 1rem 0; }

    /* ── Footer ── */
    footer { border-top: 3px solid var(--accent); padding: 2rem 0; }
    .footer-inner { display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem; }
    .footer-copy { font-size: 0.85rem; color: var(--muted); }
    .footer-contact { display: flex; gap: 1.5rem; align-items: center; flex-wrap: wrap; }
    .footer-contact a { font-size: 0.85rem; color: var(--muted); text-decoration: none; transition: color 0.15s ease; }
    .footer-contact a:hover { color: var(--accent); }

    /* ── Scroll animations ── */
    .fade-in { opacity: 0; transform: translateY(20px); transition: opacity 0.5s ease, transform 0.5s ease; }
    .fade-in.visible { opacity: 1; transform: translateY(0); }

    /* ── Page transition curtain ── */
    .curtain { position: fixed; inset: 0; background: var(--accent); z-index: 9999; transform: translateY(-100%); pointer-events: none; }
    .curtain.enter { animation: curtainEnter 0.45s cubic-bezier(0.77,0,0.18,1) forwards; }
    .curtain.exit  { animation: curtainExit  0.35s cubic-bezier(0.77,0,0.18,1) forwards; pointer-events: all; }
    @keyframes curtainEnter { from { transform: translateY(0); } to { transform: translateY(-100%); } }
    @keyframes curtainExit  { from { transform: translateY(-100%); } to { transform: translateY(0); } }
  </style>
  <noscript><style>.fade-in { opacity: 1; transform: none; }</style></noscript>
</head>
<body>
<a href="#main-content" class="skip-link">Skip to content</a>

  <header>
    <div class="container">
      <h1 class="site-title"><a href="index.html"><span>Noah Foster</span></a></h1>
      <nav aria-label="Main">
        <a href="projects.html">Projects</a>
        <a href="feed.html" aria-current="page">Feed</a>
        <a href="about.html">About</a>
        <a href="https://www.linkedin.com/in/noahbfoster/" target="_blank" rel="noopener noreferrer">LinkedIn</a>
        <a href="https://github.com/noahfoster2174" target="_blank" rel="noopener noreferrer">GitHub</a>
      </nav>
    </div>
  </header>

  <main id="main-content">

    <!-- ── Currently Training ── -->
    <section class="feed-block fade-in">
      <div class="container">
        <div class="feed-block-header">
          <h2 class="section-label">Currently Training</h2>
          <a href="https://www.strava.com/athletes/129221305" target="_blank" rel="noopener noreferrer" class="feed-link">Strava &nearr;</a>
        </div>
        <div class="training-hero">
          <h3 class="training-race"><em>Tokyo</em> Marathon 2026</h3>
          <p class="training-desc">Training for my first World Major — running 40+ miles a week through New York City. The race is March 2, 2026.</p>
        </div>
        <div class="training-stats" id="training-stats" style="display:none">
          <div class="training-stat">
            <span class="training-stat-value" id="stat-miles">—</span>
            <span class="training-stat-label">Miles this week</span>
          </div>
          <div class="training-stat">
            <span class="training-stat-value" id="stat-runs">—</span>
            <span class="training-stat-label">Runs this week</span>
          </div>
        </div>
      </div>
    </section>

    <!-- ── Currently Building ── -->
    <section class="feed-block fade-in">
      <div class="container">
        <div class="feed-block-header">
          <h2 class="section-label">Currently Building</h2>
          <a href="projects.html" class="feed-link">All projects &rarr;</a>
        </div>
        <ul class="building-list">
          <li class="building-item">
            <span class="building-name">Reelz</span>
            <span class="building-sep">&mdash;</span>
            <span class="building-desc">Home media automation with a personal movie download app.</span>
          </li>
          <li class="building-item">
            <span class="building-name">Prediction Markets</span>
            <span class="building-sep">&mdash;</span>
            <span class="building-desc">A P&L dashboard tracking handle, fees, and earnings across agents.</span>
          </li>
          <li class="building-item">
            <span class="building-name">noahfoster.com</span>
            <span class="building-sep">&mdash;</span>
            <span class="building-desc">Designed and built with Claude Code as a portfolio and experiment.</span>
          </li>
        </ul>
      </div>
    </section>

    <!-- ── Recently Watched ── -->
    <section class="feed-block fade-in">
      <div class="container">
        <div class="feed-block-header">
          <h2 class="section-label">Recently Watched</h2>
          <a href="https://letterboxd.com/noahfoster/" target="_blank" rel="noopener noreferrer" class="feed-link">Letterboxd &nearr;</a>
        </div>
        <div class="film-grid" id="film-grid">
          <p class="feed-state">Loading films...</p>
        </div>
      </div>
    </section>

  </main>

  <footer>
    <div class="container">
      <div class="footer-inner">
        <span class="footer-copy">&copy; 2026 Noah Foster</span>
        <div class="footer-contact">
          <a href="mailto:noahfoster6@gmail.com">noahfoster6@gmail.com</a>
          <a href="https://www.linkedin.com/in/noahbfoster/" target="_blank" rel="noopener noreferrer">LinkedIn</a>
          <a href="https://github.com/noahfoster2174" target="_blank" rel="noopener noreferrer">GitHub</a>
        </div>
      </div>
    </div>
  </footer>

  <div class="curtain" id="curtain"></div>

  <script>
    // ── Helpers ──
    function setText(el, text) { el.textContent = text; }
    function makeEl(tag, cls) {
      const el = document.createElement(tag);
      if (cls) el.className = cls;
      return el;
    }

    // ── Scroll animations ──
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(e => { if (e.isIntersecting) { e.target.classList.add('visible'); observer.unobserve(e.target); } });
    }, { threshold: 0.1 });
    document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));

    // ── Training stats from Strava ──
    async function loadTrainingStats() {
      try {
        const res = await fetch('strava.json');
        if (!res.ok) return;
        const activities = await res.json();
        if (!Array.isArray(activities) || !activities.length) return;

        const now = new Date();
        const dayOfWeek = now.getDay();
        const daysFromMonday = dayOfWeek === 0 ? 6 : dayOfWeek - 1;
        const weekStart = new Date(now);
        weekStart.setDate(now.getDate() - daysFromMonday);
        weekStart.setHours(0, 0, 0, 0);

        const weekRuns = activities.filter(a => new Date(a.start_date_local) >= weekStart);
        const weekMiles = (weekRuns.reduce((sum, a) => sum + a.distance, 0) / 1609.34).toFixed(1);

        if (weekRuns.length > 0) {
          setText(document.getElementById('stat-miles'), weekMiles);
          setText(document.getElementById('stat-runs'), String(weekRuns.length));
          document.getElementById('training-stats').style.display = '';
        }
      } catch {}
    }

    // ── Letterboxd poster grid ──
    async function loadLetterboxd() {
      const container = document.getElementById('film-grid');
      try {
        const rssUrl = 'https://letterboxd.com/noahfoster/rss/';
        const proxyUrl = 'https://api.allorigins.win/get?url=' + encodeURIComponent(rssUrl);
        const res = await fetch(proxyUrl);
        const data = await res.json();
        const xml = new DOMParser().parseFromString(data.contents, 'text/xml');
        const items = Array.from(xml.querySelectorAll('item')).slice(0, 8);

        if (!items.length) {
          container.replaceChildren();
          const p = makeEl('p', 'feed-state');
          setText(p, 'No films logged yet.');
          container.appendChild(p);
          return;
        }

        container.replaceChildren();
        items.forEach(item => {
          const rawTitle = item.querySelector('title')?.textContent || '';
          const title = rawTitle.replace(/,\s*\d{4}.*$/, '').replace(/\s*-\s*[\u2605\u2606\u00bd]+.*$/, '').trim();

          const memberRating = item.getElementsByTagNameNS('https://letterboxd.com', 'memberRating')[0]?.textContent;
          let rating = '';
          if (memberRating) {
            const val = parseFloat(memberRating);
            rating = '\u2605'.repeat(Math.floor(val)) + (val % 1 >= 0.5 ? '\u00bd' : '');
          }

          const desc = item.querySelector('description')?.textContent || '';
          const imgMatch = desc.match(/src="(https:\/\/[^"]+)"/);

          const card = makeEl('div', 'film-card');

          if (imgMatch) {
            const img = makeEl('img', 'film-poster');
            img.src = imgMatch[1];
            img.alt = title;
            img.loading = 'lazy';
            card.appendChild(img);
          } else {
            card.appendChild(makeEl('div', 'film-poster-placeholder'));
          }

          const titleEl = makeEl('div', 'film-title');
          setText(titleEl, title);
          card.appendChild(titleEl);

          if (rating) {
            const ratingEl = makeEl('div', 'film-rating');
            setText(ratingEl, rating);
            card.appendChild(ratingEl);
          }

          container.appendChild(card);
        });
      } catch {
        container.replaceChildren();
        const p = makeEl('p', 'feed-state');
        setText(p, 'No films logged yet.');
        container.appendChild(p);
      }
    }

    loadTrainingStats();
    loadLetterboxd();

    // ── Page transition curtain ──
    const curtain = document.getElementById('curtain');
    if (curtain) {
      curtain.classList.add('enter');
      document.querySelectorAll('a[href]').forEach(link => {
        const href = link.getAttribute('href');
        if (!href || href.startsWith('#') || href.startsWith('http') || href.startsWith('mailto')) return;
        link.addEventListener('click', e => {
          e.preventDefault();
          curtain.classList.remove('enter');
          curtain.classList.add('exit');
          setTimeout(() => { window.location.href = href; }, 350);
        });
      });
    }
  </script>
</body>
</html>
